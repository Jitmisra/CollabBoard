{"ast":null,"code":"var _jsxFileName = \"/Users/jitmisra/Desktop/ralwayhackathon/frontend/src/pages/WhiteboardRoom.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport { useSocketContext } from '../contexts/SocketContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport CollaborationRoom from '../components/CollaborationRoom';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst WhiteboardRoom = ({\n  showToast\n}) => {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const {\n    user,\n    isAuthenticated\n  } = useAuth();\n  const {\n    socket,\n    isConnected,\n    users,\n    roomData,\n    joinRoom,\n    leaveRoom\n  } = useSocketContext();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isJoining, setIsJoining] = useState(true);\n  const hasJoinedRef = useRef(false);\n\n  // Get username from location state or user account\n  useEffect(() => {\n    var _location$state;\n    const username = ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.username) || (user === null || user === void 0 ? void 0 : user.username) || 'Anonymous';\n    setCurrentUser({\n      username,\n      roomId\n    });\n    if (socket && roomId && !hasJoinedRef.current) {\n      setIsJoining(true);\n      joinRoom(roomId, username);\n      hasJoinedRef.current = true;\n\n      // Set joining to false after a short delay\n      setTimeout(() => setIsJoining(false), 1000);\n    }\n  }, [socket, roomId, location.state, user, joinRoom]);\n  const handleLeaveRoom = () => {\n    if (window.confirm('Are you sure you want to leave this room?')) {\n      leaveRoom();\n      navigate('/');\n      showToast('Left the room', 'info');\n    }\n  };\n\n  // Show loading screen while joining\n  if (isJoining || !currentUser) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gray-50 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: [\"Joining room \", roomId, \"...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 47,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-2\",\n          children: isConnected ? 'Connected to server' : 'Connecting to server...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(CollaborationRoom, {\n      user: currentUser,\n      roomId: roomId,\n      socket: socket,\n      onLeaveRoom: handleLeaveRoom,\n      showToast: showToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), !isConnected && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed top-16 left-0 right-0 bg-red-500 text-white text-center py-2 text-sm z-40\",\n      children: \"\\uD83D\\uDD34 Disconnected - Attempting to reconnect...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(WhiteboardRoom, \"Wq3IPRs0/bVIIjj+5IGAwr7GKFY=\", false, function () {\n  return [useParams, useLocation, useNavigate, useAuth, useSocketContext];\n});\n_c = WhiteboardRoom;\nexport default WhiteboardRoom;\nvar _c;\n$RefreshReg$(_c, \"WhiteboardRoom\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useLocation","useNavigate","useSocketContext","useAuth","CollaborationRoom","jsxDEV","_jsxDEV","Fragment","_Fragment","WhiteboardRoom","showToast","_s","roomId","location","navigate","user","isAuthenticated","socket","isConnected","users","roomData","joinRoom","leaveRoom","currentUser","setCurrentUser","isJoining","setIsJoining","hasJoinedRef","_location$state","username","state","current","setTimeout","handleLeaveRoom","window","confirm","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onLeaveRoom","_c","$RefreshReg$"],"sources":["/Users/jitmisra/Desktop/ralwayhackathon/frontend/src/pages/WhiteboardRoom.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useLocation, useNavigate } from 'react-router-dom';\nimport { useSocketContext } from '../contexts/SocketContext';\nimport { useAuth } from '../contexts/AuthContext';\nimport CollaborationRoom from '../components/CollaborationRoom';\n\nconst WhiteboardRoom = ({ showToast }) => {\n  const { roomId } = useParams();\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { user, isAuthenticated } = useAuth();\n  const { socket, isConnected, users, roomData, joinRoom, leaveRoom } = useSocketContext();\n  \n  const [currentUser, setCurrentUser] = useState(null);\n  const [isJoining, setIsJoining] = useState(true);\n  const hasJoinedRef = useRef(false);\n\n  // Get username from location state or user account\n  useEffect(() => {\n    const username = location.state?.username || user?.username || 'Anonymous';\n    setCurrentUser({ username, roomId });\n    \n    if (socket && roomId && !hasJoinedRef.current) {\n      setIsJoining(true);\n      joinRoom(roomId, username);\n      hasJoinedRef.current = true;\n      \n      // Set joining to false after a short delay\n      setTimeout(() => setIsJoining(false), 1000);\n    }\n  }, [socket, roomId, location.state, user, joinRoom]);\n\n  const handleLeaveRoom = () => {\n    if (window.confirm('Are you sure you want to leave this room?')) {\n      leaveRoom();\n      navigate('/');\n      showToast('Left the room', 'info');\n    }\n  };\n\n  // Show loading screen while joining\n  if (isJoining || !currentUser) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Joining room {roomId}...</p>\n          <p className=\"text-sm text-gray-500 mt-2\">\n            {isConnected ? 'Connected to server' : 'Connecting to server...'}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <CollaborationRoom\n        user={currentUser}\n        roomId={roomId}\n        socket={socket}\n        onLeaveRoom={handleLeaveRoom}\n        showToast={showToast}\n      />\n      \n      {/* Connection Status Indicator */}\n      {!isConnected && (\n        <div className=\"fixed top-16 left-0 right-0 bg-red-500 text-white text-center py-2 text-sm z-40\">\n          ðŸ”´ Disconnected - Attempting to reconnect...\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default WhiteboardRoom;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,SAAS,EAAEC,WAAW,EAAEC,WAAW,QAAQ,kBAAkB;AACtE,SAASC,gBAAgB,QAAQ,2BAA2B;AAC5D,SAASC,OAAO,QAAQ,yBAAyB;AACjD,OAAOC,iBAAiB,MAAM,iCAAiC;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAEhE,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAU,CAAC,KAAK;EAAAC,EAAA;EACxC,MAAM;IAAEC;EAAO,CAAC,GAAGb,SAAS,CAAC,CAAC;EAC9B,MAAMc,QAAQ,GAAGb,WAAW,CAAC,CAAC;EAC9B,MAAMc,QAAQ,GAAGb,WAAW,CAAC,CAAC;EAC9B,MAAM;IAAEc,IAAI;IAAEC;EAAgB,CAAC,GAAGb,OAAO,CAAC,CAAC;EAC3C,MAAM;IAAEc,MAAM;IAAEC,WAAW;IAAEC,KAAK;IAAEC,QAAQ;IAAEC,QAAQ;IAAEC;EAAU,CAAC,GAAGpB,gBAAgB,CAAC,CAAC;EAExF,MAAM,CAACqB,WAAW,EAAEC,cAAc,CAAC,GAAG5B,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC6B,SAAS,EAAEC,YAAY,CAAC,GAAG9B,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM+B,YAAY,GAAG7B,MAAM,CAAC,KAAK,CAAC;;EAElC;EACAD,SAAS,CAAC,MAAM;IAAA,IAAA+B,eAAA;IACd,MAAMC,QAAQ,GAAG,EAAAD,eAAA,GAAAf,QAAQ,CAACiB,KAAK,cAAAF,eAAA,uBAAdA,eAAA,CAAgBC,QAAQ,MAAId,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEc,QAAQ,KAAI,WAAW;IAC1EL,cAAc,CAAC;MAAEK,QAAQ;MAAEjB;IAAO,CAAC,CAAC;IAEpC,IAAIK,MAAM,IAAIL,MAAM,IAAI,CAACe,YAAY,CAACI,OAAO,EAAE;MAC7CL,YAAY,CAAC,IAAI,CAAC;MAClBL,QAAQ,CAACT,MAAM,EAAEiB,QAAQ,CAAC;MAC1BF,YAAY,CAACI,OAAO,GAAG,IAAI;;MAE3B;MACAC,UAAU,CAAC,MAAMN,YAAY,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;IAC7C;EACF,CAAC,EAAE,CAACT,MAAM,EAAEL,MAAM,EAAEC,QAAQ,CAACiB,KAAK,EAAEf,IAAI,EAAEM,QAAQ,CAAC,CAAC;EAEpD,MAAMY,eAAe,GAAGA,CAAA,KAAM;IAC5B,IAAIC,MAAM,CAACC,OAAO,CAAC,2CAA2C,CAAC,EAAE;MAC/Db,SAAS,CAAC,CAAC;MACXR,QAAQ,CAAC,GAAG,CAAC;MACbJ,SAAS,CAAC,eAAe,EAAE,MAAM,CAAC;IACpC;EACF,CAAC;;EAED;EACA,IAAIe,SAAS,IAAI,CAACF,WAAW,EAAE;IAC7B,oBACEjB,OAAA;MAAK8B,SAAS,EAAC,0DAA0D;MAAAC,QAAA,eACvE/B,OAAA;QAAK8B,SAAS,EAAC,aAAa;QAAAC,QAAA,gBAC1B/B,OAAA;UAAK8B,SAAS,EAAC;QAAgF;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACtGnC,OAAA;UAAG8B,SAAS,EAAC,eAAe;UAAAC,QAAA,GAAC,eAAa,EAACzB,MAAM,EAAC,KAAG;QAAA;UAAA0B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eACzDnC,OAAA;UAAG8B,SAAS,EAAC,4BAA4B;UAAAC,QAAA,EACtCnB,WAAW,GAAG,qBAAqB,GAAG;QAAyB;UAAAoB,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC/D,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;EAEA,oBACEnC,OAAA,CAAAE,SAAA;IAAA6B,QAAA,gBACE/B,OAAA,CAACF,iBAAiB;MAChBW,IAAI,EAAEQ,WAAY;MAClBX,MAAM,EAAEA,MAAO;MACfK,MAAM,EAAEA,MAAO;MACfyB,WAAW,EAAET,eAAgB;MAC7BvB,SAAS,EAAEA;IAAU;MAAA4B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtB,CAAC,EAGD,CAACvB,WAAW,iBACXZ,OAAA;MAAK8B,SAAS,EAAC,iFAAiF;MAAAC,QAAA,EAAC;IAEjG;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CACN;EAAA,eACD,CAAC;AAEP,CAAC;AAAC9B,EAAA,CAnEIF,cAAc;EAAA,QACCV,SAAS,EACXC,WAAW,EACXC,WAAW,EACME,OAAO,EAC6BD,gBAAgB;AAAA;AAAAyC,EAAA,GALlFlC,cAAc;AAqEpB,eAAeA,cAAc;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}