{"ast":null,"code":"var _jsxFileName = \"/Users/jitmisra/Desktop/ralwayhackathon/frontend/src/contexts/SocketContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useSocket } from '../hooks/useSocket';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/createContext();\nexport const useSocketContext = () => {\n  _s();\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocketContext must be used within a SocketProvider');\n  }\n  return context;\n};\n_s(useSocketContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const SocketProvider = ({\n  children\n}) => {\n  _s2();\n  const socket = useSocket();\n  const {\n    user\n  } = useAuth();\n  const [isConnected, setIsConnected] = useState(false);\n  const [users, setUsers] = useState([]);\n  const [roomData, setRoomData] = useState({\n    whiteboardData: [],\n    notesData: ''\n  });\n  const [currentRoomId, setCurrentRoomId] = useState(null);\n  useEffect(() => {\n    if (!socket) return;\n    const handleConnect = () => {\n      setIsConnected(true);\n    };\n    const handleDisconnect = () => {\n      setIsConnected(false);\n    };\n    const handleRoomData = data => {\n      setRoomData({\n        whiteboardData: data.whiteboardData || [],\n        notesData: data.notesData || ''\n      });\n    };\n    const handleUsersUpdate = usersList => {\n      setUsers(usersList);\n    };\n    socket.on('connect', handleConnect);\n    socket.on('disconnect', handleDisconnect);\n    socket.on('room-data', handleRoomData);\n    socket.on('users-update', handleUsersUpdate);\n\n    // Check initial connection status\n    if (socket.connected) {\n      setIsConnected(true);\n    }\n    return () => {\n      socket.off('connect', handleConnect);\n      socket.off('disconnect', handleDisconnect);\n      socket.off('room-data', handleRoomData);\n      socket.off('users-update', handleUsersUpdate);\n    };\n  }, [socket]);\n  const joinRoom = (roomId, username) => {\n    if (socket && currentRoomId !== roomId) {\n      console.log(`ðŸš€ Joining room: ${roomId} as ${username}`);\n      socket.emit('join-room', {\n        roomId,\n        username\n      });\n      setCurrentRoomId(roomId);\n    } else if (currentRoomId === roomId) {\n      console.log(`â„¹ï¸  Already in room: ${roomId}`);\n    }\n  };\n  const leaveRoom = () => {\n    if (socket) {\n      console.log(`ðŸ‘‹ Leaving room: ${currentRoomId}`);\n      setCurrentRoomId(null);\n      setUsers([]);\n      setRoomData({\n        whiteboardData: [],\n        notesData: ''\n      });\n      socket.disconnect();\n      socket.connect();\n    }\n  };\n  const value = {\n    socket,\n    isConnected,\n    users,\n    roomData,\n    joinRoom,\n    leaveRoom\n  };\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 5\n  }, this);\n};\n_s2(SocketProvider, \"QUcjMbUHXeThUv9hokrixa1F/ww=\", false, function () {\n  return [useSocket, useAuth];\n});\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useSocket","useAuth","jsxDEV","_jsxDEV","SocketContext","useSocketContext","_s","context","Error","SocketProvider","children","_s2","socket","user","isConnected","setIsConnected","users","setUsers","roomData","setRoomData","whiteboardData","notesData","currentRoomId","setCurrentRoomId","handleConnect","handleDisconnect","handleRoomData","data","handleUsersUpdate","usersList","on","connected","off","joinRoom","roomId","username","console","log","emit","leaveRoom","disconnect","connect","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/jitmisra/Desktop/ralwayhackathon/frontend/src/contexts/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useSocket } from '../hooks/useSocket';\nimport { useAuth } from './AuthContext';\n\nconst SocketContext = createContext();\n\nexport const useSocketContext = () => {\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocketContext must be used within a SocketProvider');\n  }\n  return context;\n};\n\nexport const SocketProvider = ({ children }) => {\n  const socket = useSocket();\n  const { user } = useAuth();\n  const [isConnected, setIsConnected] = useState(false);\n  const [users, setUsers] = useState([]);\n  const [roomData, setRoomData] = useState({\n    whiteboardData: [],\n    notesData: ''\n  });\n  const [currentRoomId, setCurrentRoomId] = useState(null);\n\n  useEffect(() => {\n    if (!socket) return;\n\n    const handleConnect = () => {\n      setIsConnected(true);\n    };\n\n    const handleDisconnect = () => {\n      setIsConnected(false);\n    };\n\n    const handleRoomData = (data) => {\n      setRoomData({\n        whiteboardData: data.whiteboardData || [],\n        notesData: data.notesData || ''\n      });\n    };\n\n    const handleUsersUpdate = (usersList) => {\n      setUsers(usersList);\n    };\n\n    socket.on('connect', handleConnect);\n    socket.on('disconnect', handleDisconnect);\n    socket.on('room-data', handleRoomData);\n    socket.on('users-update', handleUsersUpdate);\n\n    // Check initial connection status\n    if (socket.connected) {\n      setIsConnected(true);\n    }\n\n    return () => {\n      socket.off('connect', handleConnect);\n      socket.off('disconnect', handleDisconnect);\n      socket.off('room-data', handleRoomData);\n      socket.off('users-update', handleUsersUpdate);\n    };\n  }, [socket]);\n\n  const joinRoom = (roomId, username) => {\n    if (socket && currentRoomId !== roomId) {\n      console.log(`ðŸš€ Joining room: ${roomId} as ${username}`);\n      socket.emit('join-room', { roomId, username });\n      setCurrentRoomId(roomId);\n    } else if (currentRoomId === roomId) {\n      console.log(`â„¹ï¸  Already in room: ${roomId}`);\n    }\n  };\n\n  const leaveRoom = () => {\n    if (socket) {\n      console.log(`ðŸ‘‹ Leaving room: ${currentRoomId}`);\n      setCurrentRoomId(null);\n      setUsers([]);\n      setRoomData({ whiteboardData: [], notesData: '' });\n      socket.disconnect();\n      socket.connect();\n    }\n  };\n\n  const value = {\n    socket,\n    isConnected,\n    users,\n    roomData,\n    joinRoom,\n    leaveRoom\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}